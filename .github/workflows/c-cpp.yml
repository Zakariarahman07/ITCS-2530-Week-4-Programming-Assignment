name: C++ CI with Testing

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Install g++
      run: sudo apt-get update && sudo apt-get install -y g++

    - name: Compile C++ program
      run: g++ -Wall -Wextra -pedantic main.cpp -o main

    - name: Create test input
      run: |
        echo "+\n5\n3" > input.txt   # Example input your program expects

    - name: Create expected output
      run: |
        echo "Result: 8" > expected_output.txt  # Adjust to what your program prints

    - name: Run program with input
      run: ./main < input.txt > output.txt

    - name: Check output
      run: diff output.txt expected_output.txt
